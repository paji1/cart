function showNotification(e,t,n,o){n=n||!1,o=o||null,e||(e="Unknown error has occured. Check inputs."),$("#notify_message").removeClass(),$("#notify_message").addClass("alert-"+t),$("#notify_message").html(e),$("#notify_message").slideDown(600).delay(2500).slideUp(600,function(){o&&(window.location=o),!0===n&&location.reload()})}function slugify(e){return $.trim(e).replace(/[^a-z0-9-æøå]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").replace(/æ/gi,"ae").replace(/ø/gi,"oe").replace(/å/gi,"a").toLowerCase()}$(document).ready(function(){if($("#stripe-form").length>0&&$.ajax({method:"POST",url:"/stripe/setup"}).done(async function(e){var t=Stripe($("#stripePublicKey").val());document.querySelector("#payment-form").addEventListener("submit",async function(e){e.preventDefault(),a(!0);const{error:i}=await t.confirmPayment({elements:n,confirmParams:{return_url:$("#baseUrl").val()+"/stripe/checkout_action"}});"card_error"===i.type||"validation_error"===i.type?o(i.message):o("An unexpected error occured.");a(!1)});const n=t.elements({appearance:{theme:"stripe"},clientSecret:e.clientSecret});function o(e){const t=document.querySelector("#payment-message");t.classList.remove("hidden"),t.textContent=e,setTimeout(function(){t.classList.add("hidden"),e.textContent=""},4e3)}function a(e){e?(document.querySelector("#submit").disabled=!0,document.querySelector("#spinner").classList.remove("d-none"),document.querySelector("#button-text").classList.add("d-none")):(document.querySelector("#submit").disabled=!1,document.querySelector("#spinner").classList.add("d-none"),document.querySelector("#button-text").classList.remove("d-none"))}n.create("payment").mount("#payment-element")}).fail(function(e){showNotification(e.responseJSON.message,"danger")}),$("#stripe-form2121").length>0){var e=Stripe($("#stripePublicKey").val()),t=e.elements().create("card",{style:{base:{color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}}});t.mount("#card-element"),$(document).on("submit","#stripe-payment-form",function(n){n.preventDefault(),e.createToken(t).then(function(e){e.error?(console.log("Stripe err",e.error),showNotification("Failed to complete transaction","danger",!0)):$.ajax({type:"POST",url:"/stripe/checkout_action",data:{token:e.token.id}}).done(e=>{window.location="/payment/"+e.paymentId}).fail(e=>{console.log("Stripe err",e.error),window.location="/payment/"+e.paymentId})})})}$("#checkoutInstore").validator().on("click",function(e){e.preventDefault(),$.ajax({type:"POST",url:"/instore/checkout_action"}).done(e=>{window.location="/payment/"+e.paymentId}).fail(e=>{window.location="/payment/"+e.paymentId})}),$("#dropin-container").length>0&&$.ajax({method:"POST",url:"/adyen/setup"}).done(async function(e){const t={environment:e.environment,clientKey:e.clientKey,session:{id:e.paymentsResponse.id,sessionData:e.paymentsResponse.sessionData},onPaymentCompleted:(e,t)=>{0===$("#shipping-form").validator("validate").has(".has-error").length&&$.ajax({type:"POST",url:"/adyen/checkout_action",data:{paymentCode:e.resultCode,paymentId:t._id}}).done(e=>{window.location="/payment/"+e.paymentId}).fail(e=>{showNotification("Failed to complete transaction","danger",!0)})},onError:(e,t)=>{console.log(e.name,e.message,e.stack,t)},paymentMethodsConfiguration:{hasHolderName:!1,holderNameRequired:!1,billingAddressRequired:!1}};(await AdyenCheckout(t)).create("dropin").mount("#dropin-container")}).fail(function(e){showNotification(e.responseJSON.message,"danger")}),$("#zip-checkout").length>0&&Zip.Checkout.attachButton("#zip-checkout",{checkoutUri:"/zip/setup",onComplete:function(e){"approved"===e.state?$.ajax({type:"POST",url:"/zip/charge",data:{checkoutId:e.checkoutId}}).done(e=>{window.location="/payment/"+e.paymentId}).fail(e=>{showNotification("Failed to complete transaction","danger",!0)}):window.location="/zip/return?result="+e.state},onError:function(e){window.location="/zip/return?result=cancelled"}})});